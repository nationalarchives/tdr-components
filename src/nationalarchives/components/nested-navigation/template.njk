{% macro navigationItem(item, inputType, className, level, size, pos) %}
    {% if item.type == 'item' or item.children.length == 0 %}
        <li
                class="govuk-tna-tree__item"
                role="treeitem"
                id="{{ className }}-list-{{ item.id }}"
                aria-level="{{level}}"
                aria-setsize="{{size}}"
                aria-posinset="{{pos}}"
                aria-selected="false"
        >
            <div class="govuk-{{ className }}__item">
                <input class="govuk-{{ className }}__input" tabindex="-1" id="{{ inputType }}-{{ item.id }}" type="{{ inputType }}" name="nested-navigation"/>
                <label class="govuk-label govuk-{{ className }}__label" for="{{ inputType }}-{{ item.id }}">
                    {{item.name}}
                </label>
            </div>
        </li>

        {% elif item.type == 'node' %}
        <li
                class="govuk-tna-tree__node-item-{{ className }}"
                role="treeitem"
                id="{{ className }}-list-{{ item.id }}"
                aria-expanded="true"
                aria-selected="false"
                aria-level="{{level}}"
                aria-setsize="{{size}}"
                aria-posinset="{{pos}}"
        >
            <div class="govuk-tna-tree__node-item__container">
                <button
                        class="govuk-tna-tree__expander-{{ className }}"
                        tabindex="-1"
                        id="{{ className }}-expander-{{ item.id }}"
                >
                    <span class="govuk-visually-hidden">Expand</span>
                </button>
                <div class="govuk-{{ className }}__item">
                    <input
                            class="govuk-{{ className }}__input"
                            id="{{ inputType }}-{{ item.id }}"
                            tabindex="-1"
                            type="{{ inputType }}"
                            name="nested-navigation"
                    />
                    <label class="govuk-label govuk-{{ className }}__label" for="{{ inputType }}-{{ item.id }}">
                        {{item.name}}
                    </label>
                </div>
            </div>
            <ul class="govuk-tna-tree__nested-item-list" role="group" id="{{ className }}-node-group-{{ item.id }}">
                {% set nextLevel = level + 1 %}
                {% for child in item.children %}
                    {{ navigationItem(child, inputType, className, nextLevel, loop.length, loop.index) }}
                {% endfor %}
            </ul>
        </li>
    {% endif %}
{% endmacro %}

<div class="govuk-tna-tree">
    {% if params.inputType == 'radio' %}
        {% set className = 'radios' %}
    {% elseif params.inputType == 'checkbox' %}
        {% set className = 'checkboxes' %}
    {% endif %}
    <ul tabindex="0" id="{{ params.inputType }}-tree" class="govuk-tna-tree__nested-item-list" role="tree" aria-multiselectable="true">
        {% for node in params.items %}
            {{ navigationItem(node, params.inputType, className, 1, loop.length, loop.index) }}
        {% endfor %}
    </ul>
</div>
